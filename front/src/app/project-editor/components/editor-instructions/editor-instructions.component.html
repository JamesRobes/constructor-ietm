<div class="editor-instructions">
  <ng-container [ngSwitch]="instructionStep">
    <ng-template [ngSwitchCase]="getInsructionStep().ListInstructions">
      <button
        class="editor-instructions__btn"
        mat-raised-button
        color="primary"
        type="button"
        (click)="addInstruction()"
      >
        Добавить инструкцию
      </button>
      <div
        class="editor-instructions__wrapper-instructions"
        [ngClass]="{
          'editor-instructions__wrapper-instructions_empty': !instructions.length
        }"
      >
        <ng-container *ngIf="instructions.length; else emptyInstruction">
          <table class="editor-instructions__table">
            <thead>
              <tr class="editor-instructions__row">
                <th class="editor-instructions__column editor-instructions__column-time">id</th>
                <th class="editor-instructions__column editor-instructions__column-time">
                  Заголовок
                </th>
                <th class="editor-instructions__column editor-instructions__column-action">
                  Действия
                </th>
              </tr>
            </thead>
            <tbody>
              <tr class="item" *ngFor="let instruction of instructions; let i = index">
                <td class="editor-instructions__column editor-instructions__column-time">
                  {{ instruction.id }}
                </td>
                <td class="editor-instructions__column editor-instructions__column-time">
                  {{ instruction.title }}
                </td>
                <td class="editor-instructions__column editor-instructions__column-action">
                  <button
                    mat-icon-button
                    matTooltip="Редактировать инструкцию"
                    (click)="editInstruction(instruction, i)"
                  >
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/edit.svg"
                      alt="редактировать"
                    />
                  </button>
                  <button
                    mat-icon-button
                    matTooltip="Удалить инструкцию"
                    (click)="deleteInstruction(instruction)"
                  >
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/delete.svg"
                      alt="удалить"
                    />
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>
        <ng-template #emptyInstruction>
          <p class="editor-instructions__notify">Список инструкций пуст</p>
        </ng-template>
      </div>
    </ng-template>
    <ng-template [ngSwitchCase]="getInsructionStep().ListSteps">
      <div class="editor-instructions__wrapper-field">
        <div class="editor-instructions__row-field">
          <p class="editor-instructions__subtitle">Заголовок инструкции</p>
          <input class="editor-instructions__input" [(ngModel)]="titleInstruction" />
        </div>
        <div class="editor-instructions__row-field">
          <p class="editor-instructions__subtitle">Описание инструкции</p>
          <textarea
            class="editor-instructions__textarea"
            [(ngModel)]="descriptionInstruction"
          ></textarea>
        </div>
      </div>
      <div class="editor-instructions__actions">
        <button
          class="editor-instructions__btn"
          mat-raised-button
          color="warn"
          type="button"
          (click)="backToInstructions()"
        >
          Назад
        </button>
        <button
          class="editor-instructions__btn"
          mat-raised-button
          color="primary"
          type="button"
          (click)="addStep()"
        >
          Добавить шаг
        </button>
      </div>
      <div
        class="editor-instructions__wrapper-instructions"
        [ngClass]="{
          'editor-instructions__wrapper-instructions_empty':
            !instructions[indexInstruction].steps.length
        }"
      >
        <ng-container *ngIf="instructions[indexInstruction].steps.length; else emptySteps">
          <table class="editor-instructions__table">
            <thead>
              <tr class="editor-instructions__row">
                <th class="editor-instructions__column editor-instructions__column-time">№ Шага</th>
                <th class="editor-instructions__column editor-instructions__column-action">
                  Действия
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                class="item"
                *ngFor="let step of instructions[indexInstruction].steps; let i = index"
              >
                <td class="editor-instructions__column editor-instructions__column-time">
                  {{ step.id }}
                </td>
                <td class="editor-instructions__column editor-instructions__column-action">
                  <button
                    mat-icon-button
                    matTooltip="Редактировать шаг"
                    (click)="editStep(step, i)"
                  >
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/edit.svg"
                      alt="редактировать"
                    />
                  </button>
                  <button mat-icon-button matTooltip="Удалить шаг" (click)="deleteStep(step)">
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/delete.svg"
                      alt="удалить"
                    />
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>
        <ng-template #emptySteps>
          <p class="editor-instructions__notify">Список шагов пуст</p>
        </ng-template>
      </div>
    </ng-template>
    <ng-template [ngSwitchCase]="getInsructionStep().Step">
      <p class="editor-instructions__title">Шаг №{{ indexStep }}</p>
      <div class="editor-instructions__row-field">
        <p class="editor-instructions__subtitle">Описание шага</p>
        <textarea class="editor-instructions__textarea" [(ngModel)]="descriptionStep"></textarea>
      </div>
      <div class="editor-instructions__actions">
        <button
          class="editor-instructions__btn"
          mat-raised-button
          color="warn"
          type="button"
          (click)="stopRecordingAction()"
        >
          Остановить запись
        </button>
        <button
          class="editor-instructions__btn"
          mat-raised-button
          color="primary"
          type="button"
          (click)="startRecordingAction()"
        >
          Начать запись
        </button>
      </div>
      <div
        class="editor-instructions__wrapper-instructions"
        [ngClass]="{
          'editor-instructions__wrapper-instructions_empty':
            !instructions[indexInstruction].steps[indexStep].actions.length
        }"
      >
        <ng-container
          *ngIf="
            instructions[indexInstruction].steps[indexStep].actions.length;
            else emptyInstruction
          "
        >
          <table class="editor-instructions__table">
            <thead>
              <tr class="editor-instructions__row">
                <th class="editor-instructions__column editor-instructions__column-time">id</th>
                <th class="editor-instructions__column editor-instructions__column-time">
                  Заголовок
                </th>
                <th class="editor-instructions__column editor-instructions__column-action">
                  Действия
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                class="item"
                *ngFor="
                  let action of instructions[indexInstruction].steps[indexStep].actions;
                  let i = index
                "
              >
                <td class="editor-instructions__column editor-instructions__column-time">
                  {{ action.id }}
                </td>
                <td class="editor-instructions__column editor-instructions__column-time">
                  {{ action.type }}
                </td>
                <td class="editor-instructions__column editor-instructions__column-action">
                  <button
                    mat-icon-button
                    matTooltip="Редактировать действие"
                    (click)="editAction(action, i)"
                  >
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/edit.svg"
                      alt="редактировать"
                    />
                  </button>
                  <button
                    mat-icon-button
                    matTooltip="Удалить действие"
                    (click)="deleteAction(action)"
                  >
                    <img
                      class="editor-instructions__btn-icon"
                      src="assets/svg/delete.svg"
                      alt="удалить"
                    />
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>
        <ng-template #emptyInstruction>
          <p class="editor-instructions__notify">Список действий пуст</p>
        </ng-template>
      </div>
      <div class="editor-instructions__actions">
        <button
          class="editor-instructions__btn"
          mat-raised-button
          color="warn"
          type="button"
          (click)="backToSteps()"
        >
          Назад
        </button>
      </div>
    </ng-template>
  </ng-container>
</div>
